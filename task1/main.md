# Система управления стрелками и семафорами железнодорожных линий

## Краткое описание назначения и применения продукта

Система должна производить диспетчеризацию движения пассажирских и товарных поездов
в автоматическом режиме согласно расписаниям и текущим местоположениям составов
посредствам централизованного управления семафорами и стрелками.
Состояние инфраструктуры и положение составов в реальном времени предоставляется оператору.
Составы отслеживаются, и возможные их встречи пресекаются.
Техническое состояние путей и инфраструктуры учитывается при построении маршрута, 
отслеживается видеонаблюдением и проверяется монтерами пути.

## Ценности продукта

### Ценности

- сохранность пассажиров и поездных бригад
- перевозимые грузы
- физическая безопасность и техническое состояние подвижных составов, оборудования путей
- обеспечение максимальной пропускной способности и своевременное выполнение рейсов
- целостность и аутентичность данных о текущем положении поездов, состоянии стрелок

### Возможный ущерб/риски

- _Причина:_ столкновение поездов из-за ошибок диспетчеризации или использование несоответствующих/ненадлежащего качества путей
    - гибель людей
    - физическое повреждение составов/путей
    - утрата груза
- _Причина:_ неверные конфигурации стрелок/семафоров => задержки в движении товарных составов
    - финансовые потери (нарушение условий договоров на перевозки)
- _Причина:_ неоптимальность маршрутов
    - дополнительные расходы на топливо / з.п.
    - повышенный износ составов и полотна

## Цели безопасности

1. в результате диспетчеризации в любой момент времени составы
   движутся исключительно в соответствии с регламентом, находятся на безопасном расстоянии,
   не могут пересечься, и каким либо образом представлять опасность друг другу и/или инфраструктуре
2. поезда следуют согласно маршрутам
3. доступность и надежность системы для машиниста обеспечена постоянно
4. в любой момент времени система обладает обратной связью о местоположении составов и  
   своевременно корректирует на ее основе решения в целях оптимизации и/или обеспечения безопасности в нештатных ситуациях
5. внесение изменений в списки движения поездов, маршруты, расписания, состояние стрелок и семафоров
   возможно только авторизованным пользователям ИС с необходимыми правами
6. система анализирует и журналирует инциденты безопасности, информируя соответствующий персонал
7. система производит самодиагностику и информирует монтеров пути о необходимости произвести ремонтные работы (для участков соответствующе оборудованных)
8. система имеет возможность удаленного управления любыми контролируемыми элементами инфраструктуры,
   а также возможность ручного изменения/отмены выпущенных приказов об изменении состояния инфраструктуры

## Предположения безопасности

1. все авторизованные пользователи информационной системы, а также машинисты, поездные бригады и путейцы благонадежны 
2. компрометация используемых современных алгоритмов криптографии считается финансово невыгодной по сравнению с возможной выгодой и исключается из рассмотрения
3. Семафоры и стрелки находящиеся вдали от объектов инфраструктуры с человеческим присутствием
   **_могут_** быть подвержены любым изменениям и/или выводу из строя посредствам физического доступа
4. не рассматриваются атаки с применением физического доступа на серверное оборудование системы
5. аппаратными средствами должно быть беспечено резервирование каналов связи с инфраструктурой и локомотивом для возможности оперативной передачи команд машинисту

## Верхнеуровневые сценарии работы продукта

![](/home/petr/Desktop/cyberimmune-course-homework/task1/diagrams/normal_scenario.png)


## Неприемлемые события или сценарии в отношении ценностей продукта

### №1 - сервис управления стрелками на сервере имеет закладку и не выполняет функционал
Получаем полный отказ всей системы и бесполезность любых иных компонент, 
так как без него не имеем возможности централизованно управлять стрелками и нарушаем ЦБ2.
Его придется назначить доверенным. При этом ради уменьшения TCB не внесем туда вычисление причин смен стрелок.
Тем не менее можем оставить недоверенными объекты инфраструктуры. 
Для взаимодействия будем использовать SSL/TLS. 
Они имеют минимальную кодовую базу, а обеспечив жесткие правила по работе с сетью мы обезопасим 
себя распространения на многие сегменты, тогда как для небольшого числа все см. сценарий 2.

### №2 - физическая атака на семафоры и\или стрелки
Имеем семафоры и стрелки некоторого участка имеющие состояние полученное не от основного сервера.
Получаем возможность поездам уйти с маршрута или столкнуться (ЦБ1).

Решаем 2 путями одновременно:
1. через резервирование - информация семафоров дублируется у машиниста в кабине,
но получена по другому каналу, что позволяет проверять достоверность в случае сомнений.
2. имея телеметрию с обоих поездов можем заранее определить что движение идет не в соответствии с маршрутом
и вовремя связаться с машинистом

Будем считать машиниста компонентом системы (доверенный по ПБ),
он будет играть роль компонета повышающего целостность, так как он связывает органы управленния поездом (доверенный)
с информацией с семафоров и резервирующего канала. Оба источника могут быть недоверенными в таком случае.

### №3 - сервис телеметрии поезда передает недостоверные данные
Аналогичная ситуация возникает если скомпрометированы провайдеры местоположения поезда. 
Эту проблему решим выделив малые по размеру драйвера отдельных устройств 
и используя агрегатор местоположения - компонент повышающий целостность на основе за счет 
сравнения нескольких источников имеющий возможность оценивать вероятность компрометации каждого.
Далее предполагаем, что сервер получил измененный данные. 
Тогда возможно перенаправить поезд любым образом заставляя систему выполнять автокорректировки.

Имея машиниста доверенным, считаем, что поезд движется в случае отсутствия нештатных ситуаций 
(опоздание отправки со станции, человек/животное на путях - обычно можно использовать как минимум GSM для уведомления об этом), 
движется в рамках математической модели, поэтому введем компонент, считающий предположительное местоположение поезда на основе чисто математики,
тогда будем повышать целостность посредствам сравнений полученных данных и теории.
Также имея камеры видеонаблюдения расположенные в различных участках пути, можно получить еще один источник для сравненй.

### №4 - сервер отправляет запросы на переключение стрелок когда поезд не находится рядом
Если переключать стрелки для некоторого поезда, то необходимо быть уверенными, 
что между этим поездом и стрелкой не было другого поезда, иначе он может уехать неверно.
Избежать этого можно лишь сделать проверки местоположений (доверенные в базе данных) поездов в доверенном сервисе.

### №5 - сервер отправляет запросы на переключение стрелок не в соответствии с маршрутом
Имея скомпрометированную базу данных маршрутов или карту стрелок, 
аналогично как и сервис по генерации маршрутов под новый поезд получаем, что нет вариантов понять, поедет ли поезд правильно.
Тогда есть возможность только назначить этот сервис доверенным.

## Роли пользователей

1. Администратор
    1. настройка системы
    2. информация об инцидентах
2. Отдел логистики
    1. создание запросов на перевозку по маршруту
    2. определение требований по времени
3. Диспетчер
    1. просмотр и изменение маршрутов
    2. ручное управление инфраструктурой
    3. контроль за движением поездов
    4. контроль за состоянием инфраструктуры
4. Машинист
    1. получение маршрута
    2. уведомления об изменениях
    3. дублирование информации семафоров
5. Монтер пути
    1. получение информации о проблемах на подконтрольном участке

## Архитектура системы
![](/home/petr/Desktop/cyberimmune-course-homework/task1/diagrams/DFD.png)
